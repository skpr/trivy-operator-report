package sorter

import "github.com/aquasecurity/trivy-operator/pkg/apis/aquasecurity/v1alpha1"

type VulnerabilitySorter []v1alpha1.Vulnerability

func (a VulnerabilitySorter) Len() int {
	return len(a)
}

func (a VulnerabilitySorter) Swap(i, j int) {
	a[i], a[j] = a[j], a[i]
}

func (a VulnerabilitySorter) Less(i, j int) bool {
	iScore, jScore := float64(0.0), float64(0.0)
	if a[i].Score != nil {
		iScore = *a[i].Score
	}
	if a[j].Score != nil {
		jScore = *a[j].Score
	}
	if jScore == iScore {
		return a[i].VulnerabilityID > a[j].VulnerabilityID
	}
	return iScore > jScore
}
