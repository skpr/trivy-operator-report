package sorter

import (
	"github.com/aquasecurity/trivy-operator/pkg/apis/aquasecurity/v1alpha1"

	"github.com/skpr/trivy-operator-report/internal/extensions"
)

type VulnerabilitySorter []v1alpha1.Vulnerability

func (a VulnerabilitySorter) Len() int {
	return len(a)
}

func (a VulnerabilitySorter) Swap(i, j int) {
	a[i], a[j] = a[j], a[i]
}

func (a VulnerabilitySorter) Less(i, j int) bool {
	if a[i].Severity == a[j].Severity {
		return a[i].VulnerabilityID > a[j].VulnerabilityID
	}
	return extensions.SeverityToInt(a[i].Severity) > extensions.SeverityToInt(a[j].Severity)
}
